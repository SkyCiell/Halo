<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Keranjang Belanja - FakeStore</title>
    <link href="src/output.css" rel="stylesheet" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css"
    />
    <link
    href="https://cdn.jsdelivr.net/npm/flowbite@3.1.2/dist/flowbite.min.css"
    rel="stylesheet"
  />
  </head>
  <body class="bg-gray-100">
    <!-- Header Section -->
    <header class="sticky top-0 z-50 bg-white shadow-md">
      <div class="container mx-auto px-4 py-3">
        <div class="flex items-center justify-between">
          <!-- Logo -->
          <div class="flex items-center">
            <a
              href="homepage.html"
              class="text-3xl font-['Pacifico'] text-primary"
              >FakeStore</a
            >
          </div>
          <!-- Navigation Menu -->
          <nav class="hidden md:flex items-center space-x-8">
            <a
              href="homepage.html"
              class="text-gray-800 font-medium hover:text-primary transition-colors"
              >Beranda</a
            >
            <a
              href="#"
              class="text-gray-800 font-medium hover:text-primary transition-colors"
              >Produk Unggulan</a
            >
            <a
              href="#"
              class="text-gray-800 font-medium hover:text-primary transition-colors"
              >Kategori Produk</a
            >
          </nav>
        </div>
      </div>
    </header>

  <!-- Cart Section -->
<div class="container mx-auto px-4 py-8">
  <h1 class="text-3xl font-bold mb-8">Keranjang Belanja</h1>

  <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 items-start">
    <!-- Cart Items -->
    <div class="lg:col-span-2 lg:max-w-3xl">
      <div id="cart-items" class="space-y-4"></div>

      <div class="mt-8 flex justify-between items-center">
        <a href="homepage.html" class="text-primary hover:text-blue-600 flex items-center">
          <i class="ri-arrow-left-line mr-2"></i>
          Lanjutkan Belanja
        </a>
        <div class="flex items-center space-x-4">
          <label class="flex items-center space-x-2 cursor-pointer">
            <input type="checkbox" id="select-all" class="w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500">
            <span class="text-sm text-gray-700">Pilih Semua</span>
          </label>
        </div>
      </div>
    </div>

<!-- Order Summary -->
<div class="lg:col-span-1 w-full max-w-sm mx-auto lg:mx-0">
  <div class="bg-white rounded-xl shadow-lg p-6 sticky top-24">
    <h2 class="text-xl font-bold mb-4 text-gray-800">Ringkasan Pesanan</h2>

    <div class="space-y-3 text-sm text-gray-700">
      <div class="flex justify-between">
        <span>Subtotal</span>
        <span id="subtotal">$0.00</span>
      </div>
      <div class="flex justify-between">
        <span>Pengiriman</span>
        <span>$2.00</span>
      </div>
      <hr class="my-2 border-gray-300" />
      <div class="flex justify-between font-bold text-base text-gray-900">
        <span>Total</span>
        <span id="total">$0.00</span>
      </div>
    </div>

    <button
      class="w-full mt-6 bg-blue-600 text-white text-center py-3 rounded-lg font-medium"
      onclick="checkout()"
    >
      Checkout
    </button>
  </div>
</div>
  

    <script src="cart.js"></script>
    <script>
      // Fungsi untuk menampilkan item keranjang
      function displayCartItems() {
        const cartItems = JSON.parse(localStorage.getItem('cart')) || [];
        const cartContainer = document.getElementById('cart-items');
        const subtotalElement = document.getElementById('subtotal');
        const totalElement = document.getElementById('total');

        cartContainer.innerHTML = '';

        if (cartItems.length === 0) {
          cartContainer.innerHTML = `
            <div class="text-center py-8">
              <i class="ri-shopping-cart-line text-6xl text-gray-400 mb-4"></i>
              <p class="text-gray-500">Keranjang belanja Anda kosong</p>
            </div>
          `;
          subtotalElement.textContent = '$0.00';
          totalElement.textContent = '$0.00';
          return;
        }

        let subtotal = 0;

        cartItems.forEach((item) => {
          const itemTotal = item.price * item.quantity;
          subtotal += itemTotal;

          cartContainer.innerHTML += `
            <div class="flex items-center bg-white rounded-lg shadow-sm p-4 mb-4">
              <!-- Checkbox -->
              <div class="mr-4">
                <input type="checkbox" 
                       class="item-checkbox w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500" 
                       data-id="${item.id}"
                       data-price="${item.price}"
                       data-quantity="${item.quantity}">
              </div>

              <!-- Product Image -->
              <div class="w-16 h-16 flex-shrink-0 mr-4">
                <img src="${item.image}" alt="${item.title}" class="w-full h-full object-contain">
              </div>

              <!-- Product Title -->
              <div class="flex-grow mr-4">
                <h3 class="font-semibold text-md">${item.title}</h3>
              </div>

              <!-- Quantity Control -->
              <div class="flex items-center border border-gray-300 rounded px-0.5 mr-4 flex-shrink-0">
                <button class="quantity-btn text-gray-600 w-5 h-5 flex items-center justify-center" onclick="updateQuantity(${item.id}, ${item.quantity + 1})">+</button>
                <input class="w-8 text-center outline-none bg-transparent text-sm" type="text" value="${item.quantity}" readonly>
                <button class="quantity-btn text-gray-600 w-5 h-5 flex items-center justify-center" onclick="updateQuantity(${item.id}, ${item.quantity - 1})">-</button>
              </div>

              <!-- Total Price per Item -->
              <div class="text-right mr-4 flex-shrink-0 w-24">
                <p class="text-gray-600 text-sm">Total harga:</p>
                <p class="font-bold text-md">$${itemTotal.toFixed(2)}</p>
              </div>

              <!-- Remove Button -->
              <button
                class="text-red-500 hover:text-red-600 text-lg flex-shrink-0 w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-200"
                onclick="removeFromCart(${item.id})"
                title="Hapus"
              >
                <i class="ri-delete-bin-line"></i>
              </button>
            </div>
          `;
        });

        updateTotal();
        setupCheckboxListeners();
      }

      // Fungsi untuk mengupdate total berdasarkan item yang dipilih
      function updateTotal() {
        const selectedItems = document.querySelectorAll('.item-checkbox:checked');
        let subtotal = 0;

        selectedItems.forEach(checkbox => {
          const price = parseFloat(checkbox.dataset.price);
          const quantity = parseInt(checkbox.dataset.quantity);
          subtotal += price * quantity;
        });

        const shipping = selectedItems.length > 0 ? 2.00 : 0;
        const total = subtotal + shipping;

        document.getElementById('subtotal').textContent = `$${subtotal.toFixed(2)}`;
        document.getElementById('total').textContent = `$${total.toFixed(2)}`;
      }

      // Setup event listeners untuk checkbox
      function setupCheckboxListeners() {
        const selectAllCheckbox = document.getElementById('select-all');
        const itemCheckboxes = document.querySelectorAll('.item-checkbox');

        // Event listener untuk checkbox individual
        itemCheckboxes.forEach(checkbox => {
          checkbox.addEventListener('change', () => {
            updateTotal();
            // Update select all checkbox
            const allChecked = document.querySelectorAll('.item-checkbox:checked').length === itemCheckboxes.length;
            selectAllCheckbox.checked = allChecked;
          });
        });

        // Event listener untuk select all checkbox
        selectAllCheckbox.addEventListener('change', () => {
          itemCheckboxes.forEach(checkbox => {
            checkbox.checked = selectAllCheckbox.checked;
          });
          updateTotal();
        });
      }

      // Fungsi untuk checkout
      function checkout() {
        const selectedItems = document.querySelectorAll('.item-checkbox:checked');
        if (selectedItems.length === 0) {
          showNotification('Pilih minimal satu item untuk checkout!', 'error');
          return;
        }

        const cart = JSON.parse(localStorage.getItem('cart')) || [];
        const selectedCartItems = cart.filter(item => {
          return Array.from(selectedItems).some(checkbox => 
            parseInt(checkbox.dataset.id) === item.id
          );
        });

        // Simpan item yang dipilih ke localStorage
        localStorage.setItem('selectedCartItems', JSON.stringify(selectedCartItems));
        
        // Redirect ke halaman checkout
        window.location.href = 'checkout.html';
      }

      // Fungsi untuk menampilkan notifikasi
      function showNotification(message, type = 'success') {
        const notification = document.createElement('div');
        notification.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg ${
          type === 'success' ? 'bg-green-500' : 'bg-red-500'
        } text-white z-50`;
        notification.textContent = message;
        document.body.appendChild(notification);

        setTimeout(() => {
          notification.remove();
        }, 3000);
      }

      // Tampilkan item keranjang saat halaman dimuat
      document.addEventListener('DOMContentLoaded', () => {
        displayCartItems();
        updateCartCount();
      });
    </script>
        <script src="https://cdn.jsdelivr.net/npm/flowbite@3.1.2/dist/flowbite.min.js"></script>
  </body>
</html>
